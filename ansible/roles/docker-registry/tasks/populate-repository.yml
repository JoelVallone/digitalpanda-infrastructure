---
- name: "Pull infrastructure code from {{ infrastructure_repo.clone_url }}"
  git:
    repo: "{{ infrastructure_repo.clone_url }}"
    dest: "{{ infrastructure_repo.target_path }}"

#TODO: npm build fails as usual...
- include: "digitalpanda-frontend/build-and-push.yml"
  when: '"digitalpanda-frontend" in required_containers'

- include: "digitalpanda-backend/build-and-push.yml"
  when: '"digitalpanda-backend" in required_containers'

- include: "cassandra/build-and-push.yml"
  when: '"cassandra" in required_containers'

- include: "hadoop/build-and-push.yml"
  when: '"hadoop" in required_containers'